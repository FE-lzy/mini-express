(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41ca1b7a"],{1392:function(e,t,o){"use strict";var r=o("b152"),i=o.n(r);i.a},"975a":function(e,t,o){e.exports=o.p+"static/img/scan1.d549ec98.png"},b152:function(e,t,o){},d41b:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content"},[r("h3",{staticStyle:{"text-align":"center"}},[e._v("扫描录入")]),e._v(" "),r("h4",{staticStyle:{"text-align":"center"}},[e._v("(请确保扫描设备已连接到我的电脑)")]),e._v(" "),r("div",{staticStyle:{display:"flex","justify-content":"center"}},[r("el-input",{ref:"scanStr",staticStyle:{"text-align":"center"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请使用扫描设备扫描发票二维码，扫描过程请保持输入框聚焦状态"},on:{input:e.changeT},model:{value:e.scanStr,callback:function(t){e.scanStr=t},expression:"scanStr"}})],1),e._v(" "),r("h5"),e._v(" "),r("img",{staticStyle:{width:"100%"},attrs:{src:o("975a")}})])]),e._v(" "),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content"},[r("h2",{staticClass:"title"},[e._v("手动输入")]),e._v(" "),r("el-form",{ref:"validForm",staticClass:"demo-ruleForm form-div",attrs:{model:e.ruleForm,"status-icon":"","label-width":"120px"}},[r("el-form-item",{attrs:{label:"发票代码",prop:"invoiceCode",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[r("el-input",{attrs:{type:"text",placeholder:"输入发票代码"},model:{value:e.ruleForm.invoiceCode,callback:function(t){e.$set(e.ruleForm,"invoiceCode",t)},expression:"ruleForm.invoiceCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"发票号码",prop:"invoiceNumber",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[r("el-input",{attrs:{type:"text",placeholder:"输入发票号码"},model:{value:e.ruleForm.invoiceNumber,callback:function(t){e.$set(e.ruleForm,"invoiceNumber",t)},expression:"ruleForm.invoiceNumber"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"开票日期",prop:"billTime",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择开票日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.billTime,callback:function(t){e.$set(e.ruleForm,"billTime",t)},expression:"ruleForm.billTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"校验码后六位",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"输入校验码后六位"},model:{value:e.ruleForm.checkCode,callback:function(t){e.$set(e.ruleForm,"checkCode",t)},expression:"ruleForm.checkCode"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("validForm")}}},[e._v("查验")])],1)],1)],1)])],1)],1)},i=[],a=(o("28a5"),o("2934")),l={dwbm:localStorage.getItem("dwbm")},s={name:"scan",data:function(){return{ruleForm:{invoiceCode:"037001851107",invoiceNumber:"00879927",billTime:"2019-4-4",invoiceAmount:"",checkCode:"440055"},beginInter:!0,scanStr:"",billType:"",billOptions:[{value:"1",label:"普通发票/增值税电子发票/卷式普通发票/电子普通[通行费]发票"},{value:"2",label:"xx增值税(机动车/二手车销售发票),专用发票"}]}},mounted:function(){this.$refs.scanStr.focus()},methods:{changeT:function(e){console.log(e,this.beginInter),this.scanStr=e;var t=this;this.beginInter&&(this.beginInter=!1,setTimeout((function(){t.beginInter=!0,t.scanQuery()}),600))},fetchIsHave:function(e){var t=this;console.log(e);var o="scan"==e?this.scanStr.split(",")[3]:this.ruleForm.invoiceNumber;console.log(o),Object(a["a"])("/bill/getBillInfo",{code:o},"POST").then((function(o){console.log(o),0==o.code?t.choiceModel(JSON.parse(o.data.fp_detail.fp_detail).invoiceTypeCode,o.data,!0):"scan"==e?t.queryByScan():t.queryByCode()}))},getBillType:function(e){this.billType=e},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.fetchIsHave("code")}))},queryByCode:function(){var e=localStorage.getItem("lsToken"),t=Object.assign(this.ruleForm,l,{token:e});console.log("请求参数",t);var o=this;Object(a["a"])("/bill/queryBillByCode",t,"post").then((function(e){console.log("1232",e),0==e.code?o.choiceModel(JSON.parse(e.data.invoiceResult).invoiceTypeCode,e.data.invoiceResult,!1):(console.log(e.message),o.$message.error(e.message))})).catch((function(e){o.$message.error(e)}))},scanQuery:function(){this.scanStr&&this.fetchIsHave("scan")},queryByScan:function(){var e=this,t={scanStr:this.scanStr,token:localStorage.getItem("lsToken")};console.log("123"),Object(a["a"])("/bill/queryBillByScan",t,"post").then((function(t){console.log(t),0==t.code&&"1000"==t.data.resultCode?e.choiceModel(JSON.parse(t.data.invoiceResult).invoiceTypeCode,t.data.invoiceResult,!1):e.$message.error(t.message)}))},choiceModel:function(e,t,o){console.log(e),"01"==e||"04"==e||"10"==e?this.$router.push({name:"普通发票结果",params:{type:"scan",scanStr:t,isHave:o}}):"11"==e?this.$router.push({name:"卷式发票结果",params:{type:"scan",scanStr:t,isHave:o}}):"14"==e?this.$router.push({name:"通行证发票结果",params:{type:"scan",scanStr:t,isHave:o}}):this.$message.warning("目前仅支持查验普通发票/增值税电子发票/卷式普通发票/电子普通[通行费]发票")}}},n=s,c=(o("1392"),o("2877")),u=Object(c["a"])(n,r,i,!1,null,"dc84ddbe",null);t["default"]=u.exports}}]);