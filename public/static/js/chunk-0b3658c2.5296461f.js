(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b3658c2"],{5521:function(t,l,e){"use strict";e.r(l);var s=function(){var t=this,l=t.$createElement,e=t._self._c||l;return e("div",{staticClass:"content"},[e("div",{staticClass:"left"},[e("div",{staticClass:"top"},[e("h3",[t._v("发票查验明细")]),t._v(" "),e("p",{staticClass:"billTitle",staticStyle:{"text-align":"center"}},[t._v(t._s(t.bill.invoiceTypeName))]),t._v(" "),e("div",{staticClass:"billinfo"},[e("span",[t._v("\n          发票代码：\n          "),e("span",{staticClass:"purple"},[t._v(t._s(t.bill.invoiceDataCode))])]),t._v(" "),e("span",[t._v("\n          发票号码：\n          "),e("span",{staticClass:"purple"},[t._v(t._s(t.bill.invoiceNumber))])]),t._v(" "),e("span",[t._v("\n          开票日期：\n          "),e("span",{staticClass:"purple"},[t._v(t._s(t.bill.billingTime))])]),t._v(" "),e("span",[t._v("\n          校验码：\n          "),e("span",{staticClass:"purple"},[t._v(t._s(t.bill.checkCode))])]),t._v(" "),e("span",[t._v("\n          机器编号：\n          "),e("span",{staticClass:"purple"},[t._v(t._s(t.bill.taxDiskCode))])])])]),t._v(" "),e("div",{staticClass:"box"},[e("el-row",{staticStyle:{border:"1px solid #945555"},attrs:{type:"flex"}},[e("el-col",{attrs:{span:1}},[e("div",{staticClass:"topTitle",staticStyle:{"border-right":"1px solid #945555"}},[t._v("\n            购\n            "),e("br"),t._v("买\n            "),e("br"),t._v("方\n          ")])]),t._v(" "),e("el-col",{staticStyle:{"border-right":"1px solid #945555"},attrs:{span:16}},[e("div",{staticClass:"buyDetail"},[e("el-row",[e("el-col",{attrs:{span:6}},[t._v("名称：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.purchaserName))])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("纳税人识别号：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.taxpayerNumber))])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("地址、电话：")]),t._v(" "),e("el-col",{attrs:{span:18}})],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("开户行及账号：")]),t._v(" "),e("el-col",{attrs:{span:18}})],1)],1)]),t._v(" "),e("el-col",{attrs:{span:1}},[e("div",{staticClass:"topTitle",staticStyle:{"border-right":"1px solid #945555"}},[t._v("\n            密\n            "),e("br"),t._v("码\n            "),e("br"),t._v("区\n          ")])]),t._v(" "),e("el-col",{staticStyle:{height:"100%"},attrs:{span:6}},[e("div")])],1),t._v(" "),e("br"),t._v(" "),e("el-row",{staticClass:"goodsDetail",staticStyle:{"margin-top":"-15px"},attrs:{type:"flex"}},[e("el-col",{attrs:{span:5}},[e("el-row",[e("el-col",[t._v("货物或应税劳务、服务名称")])],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col",[t._v("规格型号")])],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col",[t._v("单位")])],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col",[t._v("数量")])],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col",[t._v("单价")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",[t._v("金额")])],1)],1),t._v(" "),e("el-col",{attrs:{span:1}},[e("el-row",[e("el-col",[t._v("税率")])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",[t._v("税额")])],1)],1)],1),t._v(" "),t._l(t.bill.detailData,(function(l){return e("el-row",{staticClass:"goodsDetail",attrs:{type:"flex"}},[e("el-col",{attrs:{span:5}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.goodserviceName))])],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.model))])],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.unit))])],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(parseFloat(l.number).toFixed(2)))])],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(parseFloat(l.price).toFixed(2)))])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.sum))])],1)],1),t._v(" "),e("el-col",{attrs:{span:1}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.taxRate))])],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v(t._s(l.tax))])],1)],1)],1)})),t._v(" "),e("el-row",{staticClass:"goodsDetail",attrs:{type:"flex"}},[e("el-col",{attrs:{span:5}},[e("el-row",[e("el-col",[t._v("合计")])],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col")],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col")],1)],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-row",[e("el-col")],1)],1),t._v(" "),e("el-col",{attrs:{span:3}},[e("el-row",[e("el-col")],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v("￥"+t._s(t.bill.totalAmount))])],1)],1),t._v(" "),e("el-col",{attrs:{span:1}},[e("el-row",[e("el-col")],1)],1),t._v(" "),e("el-col",{attrs:{span:4}},[e("el-row",[e("el-col",{staticClass:"purple"},[t._v("￥"+t._s(t.bill.totalTaxNum))])],1)],1)],1),t._v(" "),e("el-row",{staticStyle:{border:"1px solid #945555",height:"40px","line-height":"40px","text-align":"center","border-bottom":"none"},attrs:{type:"flex"}},[e("el-col",{staticStyle:{"border-right":"1px solid #945555"},attrs:{span:5}},[t._v("价格合计(大写)")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:10}},[t._v(t._s(t.bill.chineseTaxSum))]),t._v(" "),e("el-col",{attrs:{span:9}},[t._v("\n          (小写)\n          "),e("span",{staticClass:"purple"},[t._v("￥"+t._s(t.bill.totalTaxSum))])])],1),t._v(" "),e("el-row",{staticStyle:{border:"1px solid #945555"},attrs:{type:"flex"}},[e("el-col",{staticStyle:{"border-right":"1px solid #945555"},attrs:{span:1}},[e("div",{staticClass:"topTitle"},[t._v("\n            销\n            "),e("br"),t._v("售\n            "),e("br"),t._v("方\n          ")])]),t._v(" "),e("el-col",{staticStyle:{"border-right":"1px solid #945555"},attrs:{span:16}},[e("div",{staticClass:"buyDetail"},[e("el-row",[e("el-col",{attrs:{span:6}},[t._v("名称：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.salesName))])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("纳税人识别号：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.salesTaxpayerNum))])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("地址、电话：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.salesTaxpayerAddress))])],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:6}},[t._v("开户行及账号：")]),t._v(" "),e("el-col",{staticClass:"purple",attrs:{span:18}},[t._v(t._s(t.bill.salesTaxpayerBankAccount))])],1)],1)]),t._v(" "),e("el-col",{attrs:{span:1}},[e("div",{staticClass:"topTitle",staticStyle:{"border-right":"1px solid #945555"}},[t._v("\n            备\n            "),e("br"),t._v("注\n            "),e("br"),t._v("区\n          ")])]),t._v(" "),e("el-col",{staticStyle:{height:"100%"},attrs:{span:6}},[e("div",{staticClass:"purple"},[t._v(t._s(t.bill.invoiceRemarks))])])],1)],2)]),t._v(" "),e("div",{staticClass:"right"},[e("el-form",{ref:"validForm",attrs:{"label-position":t.labelPosition,"label-width":"120px",model:t.form}},[e("h2",{staticStyle:{"text-align":"center"}},[t._v("发票录入")]),t._v(" "),e("el-form-item",{attrs:{label:"发票归属部门",prop:"fp_gsbm",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[e("el-select",{attrs:{filterable:"",placeholder:"所在部门"},model:{value:t.form.fp_gsbm,callback:function(l){t.$set(t.form,"fp_gsbm",l)},expression:"form.fp_gsbm"}},t._l(t.bmOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.bmmc,value:t.id}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"发票归属人"}},[e("el-select",{attrs:{filterable:"",placeholder:"发票归属人"},model:{value:t.form.fp_gsr,callback:function(l){t.$set(t.form,"fp_gsr",l)},expression:"form.fp_gsr"}},t._l(t.userOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.zymc,value:t.id}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"备注"}},[e("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.form.fp_bz,callback:function(l){t.$set(t.form,"fp_bz",l)},expression:"form.fp_bz"}})],1),t._v(" "),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(l){return t.saveBill("validForm")}}},[t._v("录入")]),t._v(" "),e("el-button",{on:{click:function(l){return t.backJump()}}},[t._v("返回")])],1)],1)],1)])},a=[],r=e("2934");e("c5f6"),e("28a5"),e("6b54");function i(t){var l,e,s,a=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖"),r=new Array("","拾","佰","仟"),i=new Array("","万","亿","兆"),o=new Array("角","分","毫","厘"),n="整",c="元",p=1e15,v="";if(""==t)return"";if(t=parseFloat(t),t>=p)return alert("超出最大处理数字"),"";if(0==t)return v=a[0]+c+n,v;if(t=t.toString(),-1==t.indexOf(".")?(l=t,e=""):(s=t.split("."),l=s[0],e=s[1].substr(0,4)),parseInt(l,10)>0){for(var _=0,u=l.length,b=0;b<u;b++){var m=l.substr(b,1),d=u-b-1,f=d/4,h=d%4;"0"==m?_++:(_>0&&(v+=a[0]),_=0,v+=a[parseInt(m)]+r[h]),0==h&&_<4&&(v+=i[f])}v+=c}if(""!=e){var g=e.length;for(b=0;b<g;b++){m=e.substr(b,1);"0"!=m&&(v+=a[Number(m)]+o[b])}}return""==v?v+=a[0]+c+n:""==e&&(v+=n),v}var o={dwbm:localStorage.getItem("dwbm")},n={name:"Bill",data:function(){return{labelPosition:"right",form:{fp_gsr:"",fp_gsbm:"",fp_bz:""},billResJSON:"",bill:{invoiceTypeName:"",invoiceDataCode:"",invoiceNumber:"",billingTime:"",checkCode:"",taxDiskCode:"",purchaserName:"",taxpayerNumber:"",salesName:"",salesTaxpayerNum:"",salesTaxpayerBankAccount:"",salesTaxpayerAddress:"",totalTaxNum:"",totalTaxSum:"",totalAmount:"",invoiceRemarks:"",detailData:[{goodserviceName:"",sum:"",number:"",taxRate:"",model:"",price:"",tax:"",unit:""}]},bmOptions:[],userOptions:[]}},beforeMount:function(){if(!this.$route.params.scanStr)return this.$message.error("请先验证发票"),void this.$router.go(-1);this.getAllUser(),this.getAllBm()},mounted:function(){this.handleBillInfo(),this.handleUserInfo()},methods:{backJump:function(){this.$router.go(-1)},getAllBm:function(){var t=this,l={dwbm:localStorage.getItem("dwbm")};Object(r["a"])("/manager/queryAllBm",l,"POST").then((function(l){0==l.code&&(t.bmOptions=l.data.data)}))},getAllUser:function(){var t=this,l={dwbm:localStorage.getItem("dwbm"),bmbm:this.form.fp_gsbm};Object(r["a"])("/manager/queryAllUser",l,"POST").then((function(l){0==l.code&&(t.userOptions=l.data)}))},handleBillInfo:function(){if(this.$route.params.scanStr){var t=this.$route.params.scanStr;this.$route.params.isHave&&(this.$message.warning("发票已存在，请勿重复录入"),t=this.$route.params.scanStr.fp_detail.fp_detail),this.billResJSON=t,console.log("table:",t),t=JSON.parse(t),this.bill.invoiceTypeName=t.invoiceTypeName,this.bill.invoiceDataCode=t.invoiceDataCode,this.bill.invoiceNumber=t.invoiceNumber,this.bill.billingTime=t.billingTime,this.bill.checkCode=t.checkCode,this.bill.taxDiskCode=t.taxDiskCode,this.bill.purchaserName=t.purchaserName,this.bill.taxpayerNumber=t.taxpayerNumber,this.bill.salesName=t.salesName,this.bill.salesTaxpayerNum=t.salesTaxpayerNum,this.bill.salesTaxpayerBankAccount=t.salesTaxpayerBankAccount,this.bill.salesTaxpayerAddress=t.salesTaxpayerAddress,this.bill.totalTaxNum=t.totalTaxNum,this.bill.totalTaxSum=t.totalTaxSum,this.bill.totalAmount=t.totalAmount,this.bill.invoiceRemarks=t.invoiceRemarks,this.bill.detailData=t.invoiceDetailData,console.log(parseFloat(t.totalTaxSum)),this.bill.chineseTaxSum=i(parseFloat(t.totalTaxSum))}},handleUserInfo:function(){if(this.$route.params.isHave){var t=this.$route.params.scanStr;console.log(t.fp_gsr),t.fp_gsbm&&(this.form.fp_gsr=t.fp_gsr,this.form.fp_gsbm=t.fp_gsbm,this.form.fp_bz=t.fp_bz)}},saveBill:function(t){var l=this;console.log(t),""!=this.billResJSON?this.$refs[t].validate((function(t){if(t){var e=Object.assign(l.form,{billInfo:l.billResJSON},{uid:localStorage.getItem("userId")},o);console.log(e),Object(r["a"])("/bill/saveBill",e,"POST").then((function(t){0==t.code?(l.$message.success("操作成功"),l.$router.go(-1)):l.$message.error(t.message)}))}})):this.$message.error("发票信息为空,请先验证发票")}}},c=n,p=(e("ed0e"),e("2877")),v=Object(p["a"])(c,s,a,!1,null,"6cc55802",null);l["default"]=v.exports},"846c":function(t,l,e){},ed0e:function(t,l,e){"use strict";var s=e("846c"),a=e.n(s);a.a}}]);